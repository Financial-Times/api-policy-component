
varnish:
  shortName: "semanticReaderVarnish"
  path: content/
  jerseyClient:
      timeout: <%=scope.function_hiera('jerseyClientTimeout', '4000ms')%>
  primaryNodes:  <%=scope.function_hiera('semanticReaderVarnishPrimaryNodes')%>
  secondaryNodes: <%=scope.function_hiera('semanticReaderVarnishSecondaryNodes','null')%>

pipeline:
  webUrlTemplates:
      <% @webUrlTemplates.each_pair do |k, v| -%>
      "<%= k %>" : "<%= v %>"
      <% end -%>

policyBrandsMapper:
  policyFilterParameterList:
       - policy: FASTFT_CONTENT_ONLY
         forBrand:
                  - http://api.ft.com/things/5c7592a8-1f0c-11e4-b0cb-b2227cce2b54
       - policy: EXCLUDE_FASTFT_CONTENT
         notForBrand:
                  - http://api.ft.com/things/5c7592a8-1f0c-11e4-b0cb-b2227cce2b54

server:

  applicationConnectors:
    - type: http
      port: 8080

  adminConnectors:
      - type: http
        port: 8081

  requestLog:

    appenders:
      - type: file
        logFormat: "%-5p [%d{ISO8601, GMT}] %c: %X{transaction_id} %m [%thread]%n%xEx"

        # The file to which current statements will be logged.
        currentLogFilename: /var/log/apps/api-policy-component-dw-access.log

        # When the log file rotates, the archived log will be renamed to this and gzipped. The
        # %d is replaced with the previous day (yyyy-MM-dd). Custom rolling windows can be created
        # by passing a SimpleDateFormat-compatible format as an argument: "%d{yyyy-MM-dd-hh}".
        archivedLogFilenamePattern: /var/log/apps/api-policy-component-dw-access-%d.log.gz

        # The number of archived files to keep.
        archivedFileCount: 6

        # The timezone used to format dates. HINT: USE THE DEFAULT, UTC.
        timeZone: UTC

logging:

  level: <%=scope.function_hiera('logLevel','INFO') %>

  loggers:
    io.dropwizard: DEBUG

  appenders:
    - type: file
      logFormat: "%-5p [%d{ISO8601, GMT}] %c: %X{transaction_id} %m [%thread]%n%xEx"
      # Do not write log statements below this threshold to the file.
      threshold: ALL

      # The file to which current statements will be logged.
      currentLogFilename: /var/log/apps/api-policy-component-dw-app.log

      # When the log file rotates, the archived log will be renamed to this and gzipped. The
      # %d is replaced with the previous day (yyyy-MM-dd). Custom rolling windows can be created
      # by passing a SimpleDateFormat-compatible format as an argument: "%d{yyyy-MM-dd-hh}".
      archivedLogFilenamePattern: /var/log/apps/api-policy-component-dw-app-%d.log.gz

      # The number of archived files to keep.
      archivedFileCount: 5

      # The timezone used to format dates. HINT: USE THE DEFAULT, UTC.
      timeZone: UTC

metrics:
  reporters:
  - type: graphite
    frequency: 1 minute
    durationUnit: milliseconds
    rateUnit: seconds
    host: graphite.ft.com
    port: 2003
    prefix: sandbox.dynamic-publishing.<%= @ft_environment %>.api-policy-componentp-service.<%= scope['::hostname'] %>